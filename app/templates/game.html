<!-- templates/game.html -->
{% extends "base.html" %}

{% block title %}The Heist - Operation Center{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', path='css/game.css') }}">
<link rel="stylesheet" href="{{ url_for('static', path='css/chat.css') }}">
<style>
    @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;500;700;900&display=swap');
    
    :root {
        --primary: #60a5fa;
        --primary-dark: #2563eb;
        --accent: #f59e0b;
        --danger: #ef4444;
        --success: #10b981;
        --dark: #0f172a;
        --darker: #030712;
    }
    
    .page-title {
        font-family: 'Orbitron', sans-serif;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        font-weight: 700;
        background: linear-gradient(90deg, var(--primary), #ffffff, var(--primary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-size: 200% auto;
        animation: gradientText 4s linear infinite;
        text-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
    }
    
    @keyframes gradientText {
        0% { background-position: 0 0; }
        100% { background-position: 200% 0; }
    }
    
    .laser-grid {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -2;
        background-color: var(--darker);
        background-image: 
            linear-gradient(rgba(96, 165, 250, 0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(96, 165, 250, 0.05) 1px, transparent 1px);
        background-size: 30px 30px;
        animation: gridPulse 8s infinite linear;
    }
    
    @keyframes gridPulse {
        0%, 100% { opacity: 0.5; }
        50% { opacity: 0.8; }
    }
    
    .vault-texture {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -3;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect x="0" y="0" width="100" height="100" fill="%23030712"/><circle cx="50" cy="50" r="40" stroke="%232563eb" stroke-width="0.5" fill="none" opacity="0.1"/><circle cx="50" cy="50" r="30" stroke="%232563eb" stroke-width="0.5" fill="none" opacity="0.1"/><circle cx="50" cy="50" r="20" stroke="%232563eb" stroke-width="0.5" fill="none" opacity="0.1"/></svg>');
        opacity: 0.05;
    }
    
    .blueprint-highlight {
        position: fixed;
        top: 30%;
        left: 30%;
        width: 40%;
        height: 40%;
        z-index: -4;
        background: radial-gradient(ellipse at center, rgba(96, 165, 250, 0.05) 0%, transparent 70%);
        animation: highlightMove 20s infinite alternate ease-in-out;
    }
    
    .game-container {
        display: flex;
        flex-direction: column;
        height: 100vh;
        width: 100vw;
        overflow: hidden;
        margin: 0;
        padding: 0;
    }
    
    .game-content-wrapper {
        display: flex;
        flex: 1;
        overflow: hidden;
        width: 100%;
        margin: 0;
        padding: 0;
    }
    
    .game-main-area {
        flex: 1;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        margin: 0;
        padding: 0;
    }
    
    .game-chat-area {
        width: 250px;
        border-left: 1px solid rgba(96, 165, 250, 0.3);
        background: rgba(17, 24, 39, 0.8);
        overflow: hidden;
        display: flex;
        flex-direction: column;
        margin: 0 1px 1px 0;
        padding: 0;
        border-radius: 0;
    }
    
    .chat-window {
        flex: 1;
        overflow-y: auto;
        overflow-x: hidden;
        padding: 0.5rem;
    }
    
    .game-header {
        background: rgba(31, 41, 55, 0.7);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(96, 165, 250, 0.3);
        border-radius: 0;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        position: relative;
        overflow: hidden;
        margin: 0;
    }
    
    .game-header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background: linear-gradient(90deg, var(--primary-dark), var(--primary), var(--primary-dark));
        background-size: 200% 100%;
        animation: shimmer 2s infinite linear;
    }
    
    @keyframes shimmer {
        0% { background-position: 200% 0; }
        100% { background-position: 0 0; }
    }
    
    .heist-button {
        position: relative;
        background: rgba(37, 99, 235, 0.2);
        border: 2px solid var(--primary);
        color: white;
        padding: 0.75rem 1.5rem;
        font-family: 'Orbitron', sans-serif;
        font-weight: 600;
        font-size: 1rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        overflow: hidden;
        z-index: 1;
        clip-path: polygon(8px 0, 100% 0, calc(100% - 8px) 100%, 0 100%);
    }
    
    .heist-button::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
        z-index: -1;
        transform: scaleX(0);
        transform-origin: right;
        transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    
    .heist-button:hover::before {
        transform: scaleX(1);
        transform-origin: left;
    }
    
    .heist-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
        border-color: white;
    }
    
    .heist-button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
    }
    
    .heist-button-secondary {
        position: relative;
        background: rgba(75, 85, 99, 0.3);
        border: 1px solid rgba(156, 163, 175, 0.5);
        color: white;
        padding: 0.75rem 1.5rem;
        font-family: 'Share Tech Mono', monospace;
        font-weight: 500;
        letter-spacing: 0.05em;
        transition: all 0.3s ease;
        border-radius: 0.25rem;
    }
    
    .heist-button-secondary:hover {
        background: rgba(75, 85, 99, 0.5);
        border-color: rgba(156, 163, 175, 0.8);
        transform: translateY(-2px);
    }
    
    .timer {
        font-family: 'Orbitron', monospace;
        letter-spacing: 0.15em;
        background: rgba(17, 24, 39, 0.8);
        border: 1px solid rgba(96, 165, 250, 0.4);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2), inset 0 0 10px rgba(0, 0, 0, 0.3);
        position: relative;
        overflow: hidden;
    }
    
    .timer::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
            135deg,
            rgba(96, 165, 250, 0.1) 0%, 
            rgba(96, 165, 250, 0) 20%, 
            rgba(96, 165, 250, 0) 80%,
            rgba(96, 165, 250, 0.1) 100%
        );
        pointer-events: none;
    }
    
    .alert-indicator {
        text-transform: uppercase;
        letter-spacing: 0.1em;
        font-family: 'Share Tech Mono', monospace;
        font-weight: 700;
        font-size: 0.875rem;
        padding: 0.5rem 0.75rem;
        display: flex;
        align-items: center;
        border-radius: 0.25rem;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .alert-indicator::after {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(45deg, 
            rgba(255, 255, 255, 0) 0%, 
            rgba(255, 255, 255, 0.1) 50%, 
            rgba(255, 255, 255, 0) 100%
        );
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .alert-indicator:hover::after {
        opacity: 1;
    }
    
    .blueprint-grid {
        position: relative;
        background-color: rgba(30, 41, 59, 0.5);
        backdrop-filter: blur(5px);
        background-image: 
            linear-gradient(rgba(96, 165, 250, 0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(96, 165, 250, 0.05) 1px, transparent 1px);
        background-size: 20px 20px;
        border: 1px solid rgba(96, 165, 250, 0.3) !important;
        box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
    }

    /* Role cards styling */
    .role-card {
        position: relative;
        background: rgba(31, 41, 55, 0.7);
        border: 1px solid rgba(96, 165, 250, 0.3);
        backdrop-filter: blur(5px);
        overflow: hidden;
        transition: all 0.5s cubic-bezier(0.19, 1, 0.22, 1);
        transform-style: preserve-3d;
        perspective: 1000px;
    }
    
    .role-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, 
            transparent, 
            rgba(96, 165, 250, 0.1), 
            transparent);
        transition: all 0.5s cubic-bezier(0.19, 1, 0.22, 1);
    }
    
    .role-card:hover::before {
        left: 100%;
    }
    
    .role-card:hover {
        transform: translateY(-10px) rotateY(5deg);
        box-shadow: 
            10px 10px 30px rgba(0, 0, 0, 0.3),
            0 0 30px rgba(96, 165, 250, 0.2);
    }
    
    .role-card.selected {
        border: 2px solid var(--primary);
        box-shadow: 0 0 20px rgba(96, 165, 250, 0.5);
    }
    
    .puzzle-area {
        background: rgba(31, 41, 55, 0.7);
        backdrop-filter: blur(5px);
        border: 1px solid rgba(96, 165, 250, 0.3);
        box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
    }
    
    .section-header {
        font-family: 'Orbitron', sans-serif;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        position: relative;
        display: inline-block;
    }
    
    .section-header::after {
        content: '';
        position: absolute;
        bottom: -4px;
        left: 0;
        width: 100%;
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--primary), transparent);
    }

    /* Add custom scrollbar styles */
    .custom-scrollbar {
        scrollbar-width: thin;
        scrollbar-color: rgba(96, 165, 250, 0.5) rgba(17, 24, 39, 0.7);
    }

    .custom-scrollbar::-webkit-scrollbar {
        width: 4px;
    }

    .custom-scrollbar::-webkit-scrollbar-track {
        background: rgba(17, 24, 39, 0.7);
    }

    .custom-scrollbar::-webkit-scrollbar-thumb {
        background-color: rgba(96, 165, 250, 0.5);
        border-radius: 4px;
    }

    /* Add CSS for the vertical text and chat toggle */
    .vertical-text {
        writing-mode: vertical-rl;
        text-orientation: mixed;
        transform: rotate(180deg);
    }

    /* Update chat container styles for fixed layout and toggling */
    .chat-container {
        display: flex;
        flex-direction: column;
        height: 100%;
        max-height: 100%;
        overflow: hidden;
        border-radius: 0;
        margin: 0;
        padding: 0;
    }

    .chat-window {
        flex: 1;
        overflow-y: auto;
        overflow-x: hidden;
        padding: 0.5rem;
    }

    .chat-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-shrink: 0;
        padding: 0.5rem;
    }

    .chat-header .chat-title {
        flex: 1;
    }

    #chat-collapse {
        background: none;
        border: none;
        cursor: pointer;
        padding: 0.25rem;
        border-radius: 0.25rem;
        transition: background-color 0.2s;
    }

    #chat-collapse:hover {
        background-color: rgba(255, 255, 255, 0.1);
    }

    #chat-expand {
        cursor: pointer;
    }

    .chat-input-container {
        padding: 0.5rem;
        border-top: 1px solid rgba(96, 165, 250, 0.3);
        background: rgba(17, 24, 39, 0.7);
    }

    .chat-form {
        display: flex;
        position: relative;
    }

    .chat-input {
        flex: 1;
        background: rgba(31, 41, 55, 0.8);
        border: 1px solid rgba(96, 165, 250, 0.3);
        border-radius: 0.375rem;
        color: #e5e7eb;
        padding: 0.5rem;
        font-size: 0.875rem;
        transition: all 0.2s ease-in-out;
    }

    .chat-input:focus {
        outline: none;
        border-color: rgba(96, 165, 250, 0.7);
        box-shadow: 0 0 0 1px rgba(96, 165, 250, 0.3);
    }

    .chat-send-button {
        position: absolute;
        right: 0.5rem;
        top: 50%;
        transform: translateY(-50%);
        background: #3b82f6;
        border: none;
        border-radius: 50%;
        width: 1.5rem;
        height: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .chat-send-button:hover {
        background: #2563eb;
    }

    .chat-send-button:active {
        transform: translateY(-50%) scale(0.95);
    }
</style>
{% endblock %}

{% block content %}
<div class="laser-grid"></div>
<div class="vault-texture"></div>
<div class="blueprint-highlight"></div>

<!-- Pass player information to JavaScript -->
<input type="hidden" id="player-id" value="{{ player_id }}">
<input type="hidden" id="player-name" value="{{ player_name }}">

<div class="game-container">
    <div class="game-header p-4">
        <div class="flex items-center justify-between">
            <div class="flex items-center">
                <div class="w-8 h-8 mr-2 relative">
                    <div class="absolute inset-0 bg-blue-500/20 rounded-full blur-md"></div>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                    </svg>
                </div>
                <div>
                    <h1 class="page-title text-xl md:text-2xl font-bold">THE HEIST</h1>
                    <div class="text-blue-300 text-xs">SECURE OPERATION NETWORK</div>
                </div>
            </div>
            
            <div class="flex items-center">
                <span id="room-code" class="text-sm text-gray-300 font-mono bg-gray-800/50 px-3 py-1 rounded mr-4 hidden md:block">ROOM: {{ room_code }}</span>
                
                <div class="flex items-center space-x-3">
                    <button id="leave-game" class="px-3 py-1 bg-red-900/20 hover:bg-red-900/40 text-red-300 text-xs rounded border border-red-700/30 transition-colors duration-200 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                        </svg>
                        Leave Game
                    </button>
                    
                    <div class="timer-display rounded-lg px-3 py-1 bg-blue-900/40 border border-blue-700/30 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span id="timer" class="timer text-blue-300 font-mono">5:00</span>
                    </div>
                    
                    <div class="hidden md:flex items-center bg-red-900/40 px-3 py-1 rounded-lg border border-red-700/30">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                        </svg>
                        <span id="alert-level" class="text-red-300 font-mono">ALERT 0%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="game-content-wrapper">
        <div class="game-main-area">
            <!-- Game area - Active during game play -->
            <div id="game-area" class="h-full">
                <!-- Game stage content goes here -->
                <div class="p-6 h-full">
                    <div class="bg-gray-900/70 backdrop-blur rounded-lg border border-blue-900/30 shadow-lg h-full overflow-hidden flex flex-col">
                        <div class="bg-gray-900/80 backdrop-blur-sm border-b border-blue-800/30 px-6 py-3">
                            <div class="flex items-center justify-between">
                                <h2 class="section-header text-xl font-bold text-blue-400 flex items-center">
                                    <span id="current-stage" class="mr-2">STAGE 1:</span> <span id="stage-title">INFILTRATION</span>
                                </h2>
                                <div id="role-display" class="bg-blue-900/40 px-3 py-1 rounded-full border border-blue-700/30 text-xs text-blue-300 font-mono flex items-center">
                                    <div class="mr-2 size-2 bg-blue-400 rounded-full animate-pulse"></div>
                                    ROLE: <span id="player-role">PENDING</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="puzzle-area flex-1 overflow-auto custom-scrollbar p-6 relative">
                            <!-- Loading indicator -->
                            <div id="puzzle-loading" class="absolute inset-0 flex items-center justify-center">
                                <div class="flex flex-col items-center">
                                    <div class="puzzle-loader-circle rounded-full animate-spin"></div>
                                    <p class="text-blue-300 text-sm">Initializing puzzle...</p>
                                </div>
                            </div>
                            
                            <!-- Puzzle content will be inserted here -->
                            <div id="puzzle-content" class="hidden">
                                <div class="text-gray-300 text-center my-8">
                                    Waiting for puzzle assignment...
                                </div>
                            </div>
                            
                            <!-- Role instructions shown at the beginning of each puzzle -->
                            <div id="role-instruction" class="hidden bg-gray-900/80 backdrop-blur-sm border border-blue-800/30 rounded-lg p-4 mb-4">
                                <h3 class="text-blue-400 font-bold mb-2">YOUR OBJECTIVE:</h3>
                                <p class="text-gray-300 text-sm"></p>
                            </div>
                            
                            <!-- Puzzle completion message -->
                            <div id="puzzle-complete" class="hidden bg-green-900/30 backdrop-blur-sm border border-green-700/30 rounded-lg p-4 text-center">
                                <div class="mb-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </div>
                                <h3 class="text-green-400 font-bold text-lg mb-2">TASK COMPLETE!</h3>
                                <p class="text-gray-300 text-sm">Great work. Standby for the next assignment.</p>
                            </div>
                        </div>
                        
                        <div class="bg-gray-900/80 backdrop-blur-sm border-t border-blue-800/30 p-3">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400 text-xs font-mono" id="puzzle-status">LOADING...</span>
                                <div class="flex space-x-2">
                                    <button id="puzzle-hint" class="px-2 py-1 bg-blue-900/20 hover:bg-blue-900/40 text-blue-300 text-xs rounded border border-blue-700/30 transition-colors duration-200 flex items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                        Hint
                                    </button>
                                    <button id="puzzle-reset" class="px-2 py-1 bg-red-900/20 hover:bg-red-900/40 text-red-300 text-xs rounded border border-red-700/30 transition-colors duration-200 flex items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                                        </svg>
                                        Reset
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Lobby Area (Pre-game) - Takes full height when shown -->
            <div id="lobby" class="blueprint-grid rounded-lg h-full overflow-hidden flex flex-col">
                <!-- Top header with operation title -->
                <div class="bg-gray-900/80 backdrop-blur-sm border-b border-blue-800/30 px-6 py-3">
                    <div class="flex items-center justify-between">
                        <h2 class="section-header text-xl font-bold text-blue-400 flex items-center">
                            OPERATION BRIEFING
                        </h2>
                        <div class="bg-blue-900/40 px-3 py-1 rounded-full border border-blue-700/30 text-xs text-blue-300 font-mono flex items-center">
                            <div class="mr-2 size-2 bg-blue-400 rounded-full animate-pulse"></div>
                            STATUS: RECRUITING
                        </div>
                    </div>
                </div>
                
                <!-- Main content with tabs -->
                <div class="flex-1 flex overflow-hidden">
                    <!-- Left sidebar with tabs -->
                    <div class="w-16 md:w-20 bg-gray-900/80 backdrop-blur-sm border-r border-blue-800/30 flex flex-col items-center py-4 space-y-6">
                        <!-- Agent Selection Tab -->
                        <button id="tab-agents" class="tab-button active p-2 rounded-lg w-12 h-12 flex items-center justify-center bg-blue-900/50 border border-blue-700/50 text-blue-300 hover:bg-blue-800/50 transition-all" data-tab="agent-selection">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </button>
                        
                        <!-- Mission Briefing Tab -->
                        <button id="tab-mission" class="tab-button p-2 rounded-lg w-12 h-12 flex items-center justify-center bg-gray-800/50 border border-gray-700/50 text-gray-400 hover:bg-blue-800/50 hover:text-blue-300 hover:border-blue-700/50 transition-all" data-tab="mission-briefing">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                        </button>
                        
                        <!-- Team Roster Tab -->
                        <button id="tab-team" class="tab-button p-2 rounded-lg w-12 h-12 flex items-center justify-center bg-gray-800/50 border border-gray-700/50 text-gray-400 hover:bg-blue-800/50 hover:text-blue-300 hover:border-blue-700/50 transition-all" data-tab="team-roster">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                            </svg>
                        </button>
                    </div>
                    
                    <!-- Main content area -->
                    <div class="flex-1 overflow-auto custom-scrollbar p-6">
                        <!-- Tab content containers -->
                        
                        <!-- Agent Selection Tab Content (visible by default) -->
                        <div id="agent-selection" class="tab-content active">
                            <div class="bg-gray-900/70 backdrop-blur rounded-lg border border-blue-900/30 shadow-lg p-4">
                                <h3 class="font-bold text-blue-300 flex items-center mb-4">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                    </svg>
                                    SELECT YOUR SPECIALIZATION
                                </h3>
                                
                                <p class="text-gray-300 text-sm mb-4">Choose your role carefully. Each operative brings unique skills to the heist.</p>
                                
                                <div id="role-selection" class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <!-- Hacker -->
                                    <div class="role-card rounded-lg p-3 cursor-pointer overflow-hidden relative group transform transition-all duration-300 hover:scale-105" data-role="Hacker">
                                        <div class="absolute inset-0 bg-gradient-to-r from-blue-900/40 to-blue-600/20 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                                        <div class="absolute -inset-1 bg-blue-500/20 opacity-0 group-hover:opacity-100 rounded-lg blur-md transition-opacity"></div>
                                        
                                        <div class="flex items-center relative z-10">
                                            <div class="w-14 h-14 mr-3 relative flex-shrink-0">
                                                <div class="absolute inset-0 bg-blue-500/20 group-hover:bg-blue-500/40 rounded-full blur-md transition-all duration-300"></div>
                                                <img src="{{ url_for('static', path='images/hacker.png') }}" alt="Hacker" class="w-full h-full object-contain z-20 relative">
                                            </div>
                                            <div>
                                                <h4 class="text-base font-bold text-blue-400 mb-1">Hacker</h4>
                                                <p class="text-xs text-gray-300 mb-2">Digital security specialist capable of bypassing electronic measures.</p>
                                                <div class="flex items-center">
                                                    <div class="mr-2 px-2 py-0.5 bg-blue-900/50 rounded-full border border-blue-700/50">
                                                        <p class="text-xs text-blue-300">Circuit puzzles</p>
                                                    </div>
                                                    <div class="px-2 py-0.5 bg-blue-900/50 rounded-full border border-blue-700/50">
                                                        <p class="text-xs text-blue-300">Code breaking</p>
                                                    </div>
                                                </div>
                                                <p class="text-xs text-blue-300 mt-2 flex items-center">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                                    </svg>
                                                    POWER: Slow down timer
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Safe Cracker -->
                                    <div class="role-card rounded-lg p-3 cursor-pointer overflow-hidden relative group transform transition-all duration-300 hover:scale-105" data-role="Safe Cracker">
                                        <div class="absolute inset-0 bg-gradient-to-r from-yellow-900/40 to-yellow-600/20 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                                        <div class="absolute -inset-1 bg-yellow-500/20 opacity-0 group-hover:opacity-100 rounded-lg blur-md transition-opacity"></div>
                                        
                                        <div class="flex items-center relative z-10">
                                            <div class="w-14 h-14 mr-3 relative flex-shrink-0">
                                                <div class="absolute inset-0 bg-yellow-500/20 group-hover:bg-yellow-500/40 rounded-full blur-md transition-all duration-300"></div>
                                                <svg viewBox="0 0 100 100" class="w-full h-full">
                                                    <!-- Safe cracker with yellow details -->
                                                    <circle cx="50" cy="50" r="30" fill="#374151" stroke="#111827" stroke-width="2" />
                                                    <circle cx="50" cy="50" r="25" fill="#1f2937" stroke="#fcd34d" stroke-width="2" />
                                                    <circle cx="50" cy="50" r="3" fill="#fcd34d" />
                                                    <!-- Dial markings -->
                                                    <path d="M50 25 L50 30" stroke="#fcd34d" stroke-width="2" />
                                                    <path d="M50 70 L50 75" stroke="#fcd34d" stroke-width="2" />
                                                    <path d="M25 50 L30 50" stroke="#fcd34d" stroke-width="2" />
                                                    <path d="M70 50 L75 50" stroke="#fcd34d" stroke-width="2" />
                                                    <!-- Handle -->
                                                    <path d="M75 50 L85 50" stroke="#fcd34d" stroke-width="3" />
                                                </svg>
                                            </div>
                                            <div>
                                                <h4 class="text-base font-bold text-yellow-400 mb-1">Safe Cracker</h4>
                                                <p class="text-xs text-gray-300 mb-2">Expert in manipulating mechanical locks and vault systems.</p>
                                                <div class="flex items-center">
                                                    <div class="mr-2 px-2 py-0.5 bg-yellow-900/50 rounded-full border border-yellow-700/50">
                                                        <p class="text-xs text-yellow-300">Memory games</p>
                                                    </div>
                                                    <div class="px-2 py-0.5 bg-yellow-900/50 rounded-full border border-yellow-700/50">
                                                        <p class="text-xs text-yellow-300">Lock puzzles</p>
                                                    </div>
                                                </div>
                                                <p class="text-xs text-yellow-300 mt-2 flex items-center">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                                    </svg>
                                                    POWER: Skip locks
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Demolitions -->
                                    <div class="role-card rounded-lg p-3 cursor-pointer overflow-hidden relative group transform transition-all duration-300 hover:scale-105" data-role="Demolitions">
                                        <div class="absolute inset-0 bg-gradient-to-r from-red-900/40 to-red-600/20 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                                        <div class="absolute -inset-1 bg-red-500/20 opacity-0 group-hover:opacity-100 rounded-lg blur-md transition-opacity"></div>
                                        
                                        <div class="flex items-center relative z-10">
                                            <div class="w-14 h-14 mr-3 relative flex-shrink-0">
                                                <div class="absolute inset-0 bg-red-500/20 group-hover:bg-red-500/40 rounded-full blur-md transition-all duration-300"></div>
                                                <svg viewBox="0 0 100 100" class="w-full h-full">
                                                    <!-- Dynamite bundle with red details -->
                                                    <rect x="40" y="25" width="8" height="50" rx="2" fill="#ef4444" stroke="#111827" stroke-width="1" />
                                                    <rect x="52" y="25" width="8" height="50" rx="2" fill="#ef4444" stroke="#111827" stroke-width="1" />
                                                    <rect x="35" y="40" width="30" height="8" fill="#fca5a5" stroke="#111827" stroke-width="1" />
                                                    <!-- Fuse -->
                                                    <path d="M50 25 Q60 15, 70 20" stroke="#fca5a5" stroke-width="2" fill="none" />
                                                    <circle cx="70" cy="20" r="3" fill="#fef3c7" />
                                                </svg>
                                            </div>
                                            <div>
                                                <h4 class="text-base font-bold text-red-400 mb-1">Demolitions</h4>
                                                <p class="text-xs text-gray-300 mb-2">Demolitions expert capable of creating tactical breaches and distractions.</p>
                                                <div class="flex items-center">
                                                    <div class="mr-2 px-2 py-0.5 bg-red-900/50 rounded-full border border-red-700/50">
                                                        <p class="text-xs text-red-300">Timing puzzles</p>
                                                    </div>
                                                    <div class="px-2 py-0.5 bg-red-900/50 rounded-full border border-red-700/50">
                                                        <p class="text-xs text-red-300">Wiring</p>
                                                    </div>
                                                </div>
                                                <p class="text-xs text-red-300 mt-2 flex items-center">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                                    </svg>
                                                    POWER: Create shortcuts
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Lookout -->
                                    <div class="role-card rounded-lg p-3 cursor-pointer overflow-hidden relative group transform transition-all duration-300 hover:scale-105" data-role="Lookout">
                                        <div class="absolute inset-0 bg-gradient-to-r from-green-900/40 to-green-600/20 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                                        <div class="absolute -inset-1 bg-green-500/20 opacity-0 group-hover:opacity-100 rounded-lg blur-md transition-opacity"></div>
                                        
                                        <div class="flex items-center relative z-10">
                                            <div class="w-14 h-14 mr-3 relative flex-shrink-0">
                                                <div class="absolute inset-0 bg-green-500/20 group-hover:bg-green-500/40 rounded-full blur-md transition-all duration-300"></div>
                                                <svg viewBox="0 0 100 100" class="w-full h-full">
                                                    <!-- Binoculars with green details -->
                                                    <circle cx="40" cy="50" r="15" fill="#374151" stroke="#10b981" stroke-width="2" />
                                                    <circle cx="60" cy="50" r="15" fill="#374151" stroke="#10b981" stroke-width="2" />
                                                    <rect x="40" y="35" width="20" height="30" fill="#374151" />
                                                    <!-- Lenses -->
                                                    <circle cx="40" cy="50" r="8" fill="#10b981" opacity="0.6" />
                                                    <circle cx="60" cy="50" r="8" fill="#10b981" opacity="0.6" />
                                                    <!-- Strap -->
                                                    <path d="M25 50 C25 35, 75 35, 75 50" stroke="#10b981" stroke-width="2" fill="none" />
                                                </svg>
                                            </div>
                                            <div>
                                                <h4 class="text-base font-bold text-green-400 mb-1">Lookout</h4>
                                                <p class="text-xs text-gray-300 mb-2">Surveillance specialist with heightened perception abilities.</p>
                                                <div class="flex items-center">
                                                    <div class="mr-2 px-2 py-0.5 bg-green-900/50 rounded-full border border-green-700/50">
                                                        <p class="text-xs text-green-300">Pattern recognition</p>
                                                    </div>
                                                    <div class="px-2 py-0.5 bg-green-900/50 rounded-full border border-green-700/50">
                                                        <p class="text-xs text-green-300">Surveillance</p>
                                                    </div>
                                                </div>
                                                <p class="text-xs text-green-300 mt-2 flex items-center">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                                    </svg>
                                                    POWER: Detect events
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Mission Briefing Tab Content (hidden by default) -->
                        <div id="mission-briefing" class="tab-content hidden">
                            <div class="bg-gray-900/70 backdrop-blur rounded-lg border border-blue-900/30 shadow-lg p-4">
                                <h3 class="font-bold text-blue-300 flex items-center mb-4">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                    MISSION BRIEFING
                                </h3>
                                
                                <div class="space-y-6">
                                    <div class="space-y-3 text-sm">
                                        <div class="flex">
                                            <div class="w-24 text-gray-400">Operation:</div>
                                            <div class="text-white font-mono">VAULT BREACH</div>
                                        </div>
                                        <div class="flex">
                                            <div class="w-24 text-gray-400">Location:</div>
                                            <div class="text-white font-mono">CENTRAL BANK</div>
                                        </div>
                                        <div class="flex">
                                            <div class="w-24 text-gray-400">Difficulty:</div>
                                            <div class="text-yellow-400 font-mono">⚠️ MEDIUM</div>
                                        </div>
                                        <div class="flex">
                                            <div class="w-24 text-gray-400">Security:</div>
                                            <div class="text-white font-mono">ADVANCED</div>
                                        </div>
                                        <div class="flex">
                                            <div class="w-24 text-gray-400">Time Limit:</div>
                                            <div class="text-white font-mono">5:00 MINUTES</div>
                                        </div>
                                    </div>
                                    
                                    <div class="mt-4 border-t border-blue-900/30 pt-4">
                                        <h4 class="text-blue-300 font-semibold mb-2">DETAILS</h4>
                                        <p class="text-gray-300 text-sm">The Central Bank's primary vault contains assets worth millions. Security systems include electronic locks, motion sensors, and a sophisticated alarm system. Your mission is to breach the vault, extract the target assets, and escape before security forces arrive.</p>
                                    </div>
                                    
                                    <div class="mt-4 border-t border-blue-900/30 pt-4">
                                        <h4 class="text-blue-300 font-semibold mb-2">OBJECTIVES</h4>
                                        <ul class="list-disc list-inside text-gray-300 text-sm space-y-2">
                                            <li>Disable security systems without triggering alerts</li>
                                            <li>Breach the main vault door</li>
                                            <li>Locate and secure the target assets</li>
                                            <li>Escape through the extraction point</li>
                                            <li>Maintain stealth throughout the operation</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="mt-4 border-t border-blue-900/30 pt-4">
                                        <h4 class="text-blue-300 font-semibold mb-2">REWARD</h4>
                                        <p class="text-white font-bold">$5,000,000</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Team Roster Tab Content (hidden by default) -->
                        <div id="team-roster" class="tab-content hidden">
                            <div class="bg-gray-900/70 backdrop-blur rounded-lg border border-blue-900/30 shadow-lg p-4">
                                <h3 class="font-bold text-blue-300 flex items-center mb-4">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                    </svg>
                                    ACTIVE OPERATIVES
                                </h3>
                                
                                <div class="mb-4 flex justify-between items-center">
                                    <span class="text-gray-300 text-sm"><span class="text-blue-300 font-mono" id="player-count">0</span> / <span class="text-blue-300 font-mono">4</span> Operatives Connected</span>
                                    <span class="text-xs text-blue-200 font-mono bg-blue-900/30 px-2 py-1 rounded">4 REQUIRED</span>
                                </div>
                                
                                <div id="player-list" class="space-y-3">
                                    <!-- Players will be added here by JS -->
                                    
                                    <!-- Example placeholder player -->
                                    <div class="flex items-center bg-gray-800/50 rounded p-3 border border-gray-700/50">
                                        <div class="w-10 h-10 rounded-full bg-blue-800/50 flex items-center justify-center mr-3 text-blue-300">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                            </svg>
                                        </div>
                                        <div class="flex-grow">
                                            <div class="flex items-center justify-between">
                                                <p class="text-white text-sm font-semibold">Waiting for player...</p>
                                                <span class="text-gray-400 text-xs">Connecting...</span>
                                            </div>
                                            <div class="flex items-center mt-1">
                                                <span class="text-gray-400 mr-2">○</span>
                                                <span class="text-gray-400 text-sm italic">Selecting role...</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Bottom action bar with start button -->
                <div class="bg-gray-900/80 backdrop-blur-sm border-t border-blue-800/30 p-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span class="text-sm text-gray-300">Select a role to begin. All team members must choose a unique role.</span>
                        </div>
                        <button id="start-game" class="heist-button text-sm relative group disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none py-2 px-6" disabled>
                            <span class="relative flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                </svg>
                                <span>INITIATE OPERATION</span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Chat area - Right side (always visible) -->
        <div class="game-chat-area">
            <div class="chat-container h-full">
                <div class="chat-header">
                    <h3 class="chat-title">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                        </svg>
                        Team Comms
                    </h3>
                    <span class="chat-status">
                        <span class="chat-status-dot"></span>
                        LIVE
                    </span>
                </div>
                
                <div id="chat-window" class="chat-window">
                    <!-- Messages will appear here -->
                </div>
                
                <div class="chat-input-container">
                    <form id="chat-form" class="chat-form">
                        <input type="text" id="chat-input" class="chat-input" placeholder="Message..." autocomplete="off">
                        <button type="submit" class="chat-send-button">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add missing elements for GameUIManager and NotificationSystem -->
<div id="game-elements" class="hidden">
    <!-- Stage info elements -->
    <div id="stage-number" class="hidden">Stage 1/5</div>
    <div id="stage-name" class="hidden">INFILTRATION</div>
    <div id="stage-progress" class="hidden"></div>
    <div id="team-status" class="hidden"></div>
    
    <!-- Action buttons -->
    <button id="use-power" class="hidden">Use Power</button>
    <button id="extend-timer" class="hidden">Extend Timer</button>
    
    <!-- Game over modal -->
    <div id="game-over-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm">
        <div class="bg-gray-900/90 p-6 rounded-lg border border-blue-800/50 shadow-2xl max-w-md w-full">
            <h2 class="text-2xl font-bold text-center mb-4">
                Mission <span id="game-result" class="text-blue-400">Complete</span>
            </h2>
            <p id="game-result-message" class="text-gray-300 text-center mb-6">
                Your team successfully completed the heist!
            </p>
            <div class="flex justify-center space-x-4">
                <button id="play-again" class="heist-button text-sm py-2 px-4">Play Again</button>
                <button id="return-home" class="heist-button-secondary py-2 px-4">Return Home</button>
            </div>
        </div>
    </div>
    
    <!-- Timer vote modal -->
    <div id="timer-vote-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm">
        <div class="bg-gray-900/90 p-6 rounded-lg border border-blue-800/50 shadow-2xl max-w-md w-full">
            <h2 class="text-xl font-bold text-center mb-4">Vote to Extend Timer</h2>
            <div class="mb-4">
                <p class="text-gray-300 text-center">
                    <span id="vote-count">0/4</span> players voted to extend the timer
                </p>
                <div class="bg-gray-800 h-2 rounded-full mt-2">
                    <div id="vote-progress" class="bg-blue-500 h-2 rounded-full" style="width: 0%"></div>
                </div>
            </div>
            <div id="vote-player-list" class="mb-4 bg-gray-800/50 p-3 rounded-lg max-h-32 overflow-y-auto">
                <!-- Vote player list will be populated dynamically -->
            </div>
            <div class="flex justify-between items-center">
                <div class="text-sm text-gray-400">
                    Time remaining: <span id="vote-timer">20</span>s
                </div>
                <div class="flex space-x-3">
                    <button id="vote-yes" class="px-4 py-2 bg-green-700 hover:bg-green-600 rounded text-white">Vote Yes</button>
                    <button id="vote-no" class="px-4 py-2 bg-red-700 hover:bg-red-600 rounded text-white">Vote No</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Notification system -->
<div id="alert-notification" class="fixed bottom-4 right-4 text-white p-4 rounded-lg shadow-lg z-40 hidden">
    <div id="alert-message"></div>
</div>

<!-- Leave Game Modal -->
<div id="leave-game-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm">
    <div class="bg-gray-900/90 p-6 rounded-lg border border-blue-800/50 shadow-2xl max-w-md w-full">
        <h2 class="text-xl font-bold text-center mb-4 text-red-400">Leave Operation?</h2>
        <p class="text-gray-300 text-center mb-6">
            Are you sure you want to leave this operation? Your team will have to continue without you.
        </p>
        <div class="flex justify-center space-x-4">
            <button id="confirm-leave" class="px-4 py-2 bg-red-700 hover:bg-red-600 rounded text-white">Leave Operation</button>
            <button id="cancel-leave" class="px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded text-white">Stay</button>
        </div>
    </div>
</div>

<!-- Update the scanner animation to work with fixed height -->
<style>
    @keyframes scannerMove {
        0% { transform: translateY(0); }
        100% { transform: translateY(100%); }
    }
    
    .scanner-animation {
        background: linear-gradient(90deg, 
            rgba(37, 99, 235, 0), 
            rgba(37, 99, 235, 0.5), 
            rgba(37, 99, 235, 0));
        animation: scannerMove 3s infinite alternate ease-in-out;
        opacity: 0.7;
    }
    
    /* Make puzzle loader smaller */
    .puzzle-loader-circle {
        width: 30px;
        height: 30px;
        border: 2px solid rgba(37, 99, 235, 0.3);
        border-top: 2px solid rgba(37, 99, 235, 0.8);
        margin-bottom: 8px;
    }
</style>

<!-- Load game script bundle instead of individual files -->
<script src="{{ url_for('static', path='js/main.bundle.js') }}" type="module"></script>
<script src="{{ url_for('static', path='js/game.js') }}" type="module"></script>
<script src="{{ url_for('static', path='js/roleEffects.js') }}"></script>
<script src="{{ url_for('static', path='js/chat.js') }}" type="module"></script>
{% endblock %}